# OPHANION Configuration File
# Version 1.0

[ophanion]
# Number of Gabriel Cells in the cluster
# More cells = better pattern recognition but higher memory usage
# Recommended: 64-128 for typical hidden services
num_gabriel_cells = 64

# Dimensionality of spectral signature vectors
# Must match spectral fingerprint output
spectral_dim = 128

# Learning rate for Gabriel Cell centroid updates
# Higher = faster adaptation, lower = more stable
# Range: 0.001 - 0.1
learning_rate_alpha = 0.01

# Decay rate for connection weights
# Higher = faster forgetting of old patterns
# Range: 0.0001 - 0.01
decay_rate_beta = 0.001

# Initial threshold value for resonance filtering
# Higher = more aggressive filtering
# Range: 0.0 - 1.0, recommended: 0.4 - 0.6
initial_threshold = 0.5

# Learning rate for threshold adaptation
# Higher = faster threshold adjustment
# Range: 0.0001 - 0.01
threshold_learning_rate = 0.001

# Optimization step size for Delta-Kernel
# Smaller = more stable convergence
# Range: 0.00001 - 0.001
optimization_eta = 0.0001

# Target absorption rate (0.0 - 1.0)
# System will optimize towards this goal
# Recommended: 0.90 - 0.98
target_absorption_rate = 0.95

# Convergence epsilon for gradient
# Lower = stricter convergence criterion
convergence_epsilon = 0.001

[tor]
# Tor control port (default: 9051)
control_port = 9051

# Path to Tor control authentication cookie
# Default location for Debian/Ubuntu
cookie_path = "/var/run/tor/control.authcookie"

# Alternative: password authentication (if cookie not available)
# Uncomment and set password in torrc: HashedControlPassword
# control_password = "your_password_here"

[service]
# Port where OPHANION listens (receives from Tor)
# This should match HiddenServicePort in torrc
listen_port = 8080

# Port where your actual hidden service runs
# OPHANION forwards legitimate traffic here
backend_port = 8081

# Bind address (typically localhost)
bind_address = "127.0.0.1"

[monitoring]
# Enable Prometheus metrics endpoint
enable_metrics = true

# Metrics server port
metrics_port = 9090

# Enable detailed debug logging
# Warning: generates large log files under attack
verbose_logging = false

# Log file path
# Ensure directory exists and is writable
log_file = "/var/log/ophanion/ophanion.log"

[performance]
# Worker thread count
# 0 = auto-detect based on CPU cores
# Manual setting: number of CPU cores
worker_threads = 0

# Maximum circuits tracked simultaneously
# Higher = more memory usage
# Typical: 1000-10000
max_tracked_circuits = 10000

# Circuit metadata retention time (seconds)
# Circuits older than this are forgotten
# 3600 = 1 hour
metadata_retention = 3600

# Advanced configuration examples:

# For low-traffic hidden services (< 100 circuits/hour):
# num_gabriel_cells = 32
# learning_rate_alpha = 0.02
# initial_threshold = 0.4

# For high-traffic marketplaces (> 1000 circuits/hour):
# num_gabriel_cells = 128
# max_tracked_circuits = 20000
# worker_threads = 4

# For paranoid security (minimal false positives):
# initial_threshold = 0.3
# learning_rate_alpha = 0.005
# target_absorption_rate = 0.90

# For aggressive defense (under heavy attack):
# initial_threshold = 0.7
# learning_rate_alpha = 0.03
# target_absorption_rate = 0.98
